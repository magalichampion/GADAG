% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/GADAG_CV.R
\name{GADAG_CV}
\alias{GADAG_CV}
\title{Cross-validation for GADAG}
\usage{
GADAG_CV(X, Lambdas = NULL, n.folds = 10, threshold = 0.1,
  GADAG.control = list(n.gen = 100, tol.Shannon = 1e-06, max.eval = 10000,
  pop.size = 10, p.xo = 0.25, p.mut = 0.05), grad.control = list(tol.obj.inner
  = 1e-06, max.ite.inner = 50), ncores = 1, plot.CV = 0)
}
\arguments{
\item{X}{Design matrix, with samples (n) in rows and variables (p) in columns.}

\item{Lambdas}{Optional user-supplied lambda sequence. Default is null and GADAG chooses its own sequence.}

\item{n.folds}{Number of folds for cross-validation (10 by default). Can be as large as the sample size (leave-one-out cross validation) but not recommended for large data sets.}

\item{threshold}{Thresholding value for the estimated edges.}

\item{GADAG.control}{A list containing parameters for controlling GADAG (termination conditions and inherent parameters of the Genetic Algortihm).
Some parameters (n.gen, max.eval and pop.size) are particularly critical for reducing the computational time.
\itemize{
\item{\code{n.gen}}{ maximal number of population generations (>0),}
\item{\code{pop.size}}{ initial population size for the genetic algorithm (>0),}
\item{\code{max.eval}}{ overall maximal number of calls of the evaluation function (>0, should be of the order of \code{n.gen}*\code{pop.size}),}
\item{\code{tol.Shannon}}{ threshold for the Shannon entropy (>0),}
\item{\code{p.xo}}{ crossover probability of the genetic algorithm (between 0 and 1),}
\item{\code{p.mut}}{ mutation probability of the genetic algorithm (between 0 and 1).}
}}

\item{grad.control}{A list containing the parameters for controlling the inner optimization, i.e. the gradient descent.
\itemize{
\item{\code{tol.obj.inner}}{ tolerance (>0),}
\item{\code{max.ite.inner}}{ maximum number of iterations (>0).}
}}

\item{ncores}{Number of cores (>0, depending on your computer).}

\item{plot.CV}{If 1, plots the averaged cross validation error given sequence of lambdas.}
}
\value{
A list with the following elements:
\itemize{
\item{\code{lambda.min}}{ Value of \code{lambda} that minimizes the averaged cross validation error \code{error.CV}.}
\item{\code{nzero}}{ Number of non-zero coefficients at each \code{lambda}.}
\item{\code{Lambdas}}{ The values of \code{lambda} used in the fits.}
\item{\code{error.CV}}{ The averaged cross validation error.}
}
}
\description{
Function to run k-fold cross-validation for GADAG to optimally tune the parameter of penalization.
}
\details{
The function runs \code{GADAG} \code{n.folds} times for each of the tested lambdas to compute the best solution associated to each omitted fold. The error is accumulated and the averaged error over the folds is computed. The best lambda \code{lambda.min} corresponds to the one that minimizes the error.
}
\examples{
 #############################################################
 # Loading toy data
 #############################################################
 data(toy_data)
 # toy_data is a list of two matrices corresponding to a "star"
 # DAG (node 1 activates all other nodes):
 # - toy_data$X is a 100x10 design matrix
 # - toy_data$G is the 10x10 adjacency matrix (ground trough)

 #############################################################
 # Tuning the parameter of penalization
 #############################################################
 # Simple run, whithout specifying GADAG parameters
 \dontrun{
 GADAG_CV_results <- GADAG_CV(X=toy_data$X)
 print(GADAG_CV_results$lambda.min) # best lambda
 }
 # If desired, additional plot for the averaged cross validation
 # error
 \dontrun{
 GADAG_CV_results <- GADAG_CV(X=toy_data$X,plot.CV=1)
 }
 # Given the best lambda, re-run GADAG
 \dontrun{
 GADAG_results <- GADAG_Run(X=toy_data$X, lambda=GADAG_CV_results$lambda.min)
 print(GADAG_results$G.best) # optimal adjacency matrix graph
 }
}
\references{
M. Champion, V. Picheny, M. Vignes, Inferring large graphs using l-1 penalized likelihood,
Statistics and Computing (2017).
}
\seealso{
\code{\link{GADAG}}, \code{\link{GADAG_Run}}, \code{\link{GADAG_Analyze}}.
}
\author{
\packageAuthor{GADAG}
}
